<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Time Series Analysis in R | Community Contributions Test</title>
<meta name="description" content="Sebastian Carter library(stats) library(tidyverse) library(forecast) library(bayesforecast) library(ggplot2)  5.1 Introducing Time Series Time series data consists of observations collected over a...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 5 Time Series Analysis in R | Community Contributions Test">
<meta property="og:type" content="book">
<meta property="og:description" content="Sebastian Carter library(stats) library(tidyverse) library(forecast) library(bayesforecast) library(ggplot2)  5.1 Introducing Time Series Time series data consists of observations collected over a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Time Series Analysis in R | Community Contributions Test">
<meta name="twitter:description" content="Sebastian Carter library(stats) library(tidyverse) library(forecast) library(bayesforecast) library(ggplot2)  5.1 Introducing Time Series Time series data consists of observations collected over a...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Community Contributions Test</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li><a class="active" href="time-series-analysis-in-r.html"><span class="header-section-number">5</span> Time Series Analysis in R</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">6</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">7</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cctest">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="time-series-analysis-in-r" class="section level1">
<h1>
<span class="header-section-number">5</span> Time Series Analysis in R<a class="anchor" aria-label="anchor" href="#time-series-analysis-in-r"><i class="fas fa-link"></i></a>
</h1>
<p>Sebastian Carter</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bayesforecast</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div id="introducing-time-series" class="section level2">
<h2>
<span class="header-section-number">5.1</span> Introducing Time Series<a class="anchor" aria-label="anchor" href="#introducing-time-series"><i class="fas fa-link"></i></a>
</h2>
<p>Time series data consists of observations collected over a period of time. Often times with time series, observations are affected by the previous (or many preceding) points. For example, suppose you are collecting wind speed data. It is obvious that the wind speed at this current moment of time is dependent on the wind speed one minute ago. This characteristic makes time series analysis a unique area of study and requires us to build on our understanding and education in linear regression. In linear regression, we make the key assumption that error terms are independent. However, crucially, in time series data this is often not the case.</p>
<div id="eda-of-time-series-data" class="section level3">
<h3>
<span class="header-section-number">5.1.1</span> EDA of Time Series Data<a class="anchor" aria-label="anchor" href="#eda-of-time-series-data"><i class="fas fa-link"></i></a>
</h3>
<p>Time series data often has a seasonal component, a trend component, and an error term. We are familiar with the linear regression model,
<span class="math display">\[
Y_i = \beta_0 + \beta_1X_i + \epsilon_i
\]</span>
or more qualitatively,
<span class="math display">\[
Y = \text{trend} + \epsilon .
\]</span></p>
<p>Similarly, we can write time series data in the following form:</p>
<p><span class="math display">\[
Y_t = \text{seasonal}_t + \text{trend}_t + \epsilon_t
\]</span></p>
<p>In the above equation, we have denoted <span class="math inline">\(\{Y_t\}\)</span> to be the time series data of interest, say wind speed. Eventually, we will attempt to “de-trend” <span class="math inline">\(\{Y_t\}\)</span>, which essentially means removing the seasonal and trend component from the data. First, let’s examine methods to identify these components.</p>
<p>We will use the <code>decompose</code> function, which is a very helpful tool for data scientists to conduct a quick analysis of seasonal and trend components of time series data.</p>
<div id="example" class="section level4">
<h4>
<span class="header-section-number">5.1.1.1</span> Example<a class="anchor" aria-label="anchor" href="#example"><i class="fas fa-link"></i></a>
</h4>
<p>In this example, we examine the maximum temperature in Boston per month. The first plot displays the measured data. The second plot displays the trend, which is typically calculated using a moving average. Next, the season trend is determined and displayed. The final plot displays the residuals, which is the data after subtracting the trend and seasonal components of the data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BosTemp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"resources/timeseriesanalysis/boston_monthly_tmax_1998_2019.csv"</span><span class="op">)</span>

<span class="va">BosTemp</span><span class="op">$</span><span class="va">DateTime</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">BosTemp</span><span class="op">$</span><span class="va">Date</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">BosTemp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1998</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">decompose</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">autoplot</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></div>
<div id="important-data-wrangling" class="section level5">
<h5>
<span class="header-section-number">5.1.1.1.1</span> Important Data Wrangling<a class="anchor" aria-label="anchor" href="#important-data-wrangling"><i class="fas fa-link"></i></a>
</h5>
<p>As with most data visualization tools, the <code><a href="https://rdrr.io/r/stats/decompose.html">decompose()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> functions take in a <code>ts</code> object. The <code>decompose</code> function will not accept a dataframe of time series data that we are familiar with. We must convert the dataframe into a time series object.</p>
<p>Below is a preview of the data we have loaded.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">BosTemp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">DateTime</span>, <span class="va">Monthly.Average.Maximum</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##     DateTime Monthly.Average.Maximum
## 1 1998-01-15                   39.71
## 2 1998-02-15                   40.97
## 3 1998-03-15                   48.75
## 4 1998-04-15                   56.74
## 5 1998-05-15                   68.75
## 6 1998-06-15                   72.00</code></pre>
<p>The <code>ts</code> function can be used to convert this dataframe into a time series object. The first argument in the <code>ts</code> function take the data (in vector or matrix form), the “start” argument takes the time of the first observation, and the frequency function takes the number of observations per unit of time. So, for this example, we have monthly data that starts in 1998, so <code>start = 1998</code> and <code>frequency = 12</code>.</p>
<p>So, below is the Boston temperature data converted into a time series object, which will be accepted by <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BosTemp_ts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">BosTemp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1998</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">BosTemp_ts</span>,<span class="fl">12</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>##        Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec
## 1998 39.71 40.97 48.75 56.74 68.75 72.00 82.62 80.20 74.44 61.59 50.77 46.30
## 1999 37.46 40.79 47.23 57.27 65.65 79.87 84.20 78.94 74.24 61.42 55.57 43.94
## 2000 35.68 41.42 51.07 54.40 65.91 75.44 77.07 77.10 71.64 61.68 49.17 35.88
## 2001 36.17 39.18 40.62 56.70 67.97 79.74 77.88 81.10 73.34 65.00 56.14 46.39
## 2002 42.42 44.61 47.81 58.64 66.71 75.00 84.04 83.17 76.10 59.07 49.14 39.23</code></pre>
</div>
</div>
</div>
<div id="autocorrelation-plot-acf" class="section level3">
<h3>
<span class="header-section-number">5.1.2</span> Autocorrelation Plot (ACF)<a class="anchor" aria-label="anchor" href="#autocorrelation-plot-acf"><i class="fas fa-link"></i></a>
</h3>
<p>After we have de-trended the data, we want to examine the residuals in order to understand the error structure (and eventually be able to forecast). The Autocorrelation Plot (ACF) is a very important tool in time series EDA as it can give us insights into the error structure and help us determine an appropriate model. The ACF plot basically calculates and displays the correlation coefficient between a time series and its lagged values. For example, the lag 1 autocorrelation is the correlation between <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_{t-1}\)</span> for all <span class="math inline">\(t&gt;1\)</span>. Likewise, lag 2 autocorrelation is the autocorrelation between <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_{t-2}\)</span>, i.e. the correlation between the <span class="math inline">\(t^{th}\)</span> observation and the <span class="math inline">\({(t-2)}^{th}\)</span> observation.</p>
<p>We will use the <code>ggacf</code> function within the <code>bayesforecast</code> package to create an autocorrelation plot (also known as a correlogram).</p>
<div id="example-1" class="section level4">
<h4>
<span class="header-section-number">5.1.2.1</span> Example<a class="anchor" aria-label="anchor" href="#example-1"><i class="fas fa-link"></i></a>
</h4>
<p>For iid error, we do not expect correlation between lags. Below is an acf plot of iid error. If multiple black lines cross the dashed blue line boundaries, we may reject the null hypothesis that the lags are uncorrelated.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>
<span class="va">error</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">Y</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">t</span> <span class="op">+</span><span class="va">error</span> 

<span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">Y</span><span class="op">)</span>

<span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggacf.html">ggacf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="example-2" class="section level4">
<h4>
<span class="header-section-number">5.1.2.2</span> Example<a class="anchor" aria-label="anchor" href="#example-2"><i class="fas fa-link"></i></a>
</h4>
<p>Now, let’s examine a case where the errors are correlated, and demonstrate how the ACF plot is very useful in identifying this characteristic. Again, we will use the Boston temperature dataset.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggacf.html">ggacf</a></span><span class="op">(</span><span class="va">BosTemp_ts</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Clearly, we observe a harmonic trend, since we have not removed the seasonal or trend components from the data. However, we can extract the de-trended time series data from the decompose function that we used earlier. The residuals look much more iid than before, and this is a good first step in modelling the time series data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggacf.html">ggacf</a></span><span class="op">(</span><span class="op">(</span><span class="va">BosTemp_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">decompose</span><span class="op">)</span><span class="op">$</span><span class="va">random</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="partial-autocorrelation-plot-pacf" class="section level3">
<h3>
<span class="header-section-number">5.1.3</span> Partial Autocorrelation Plot (PACF)<a class="anchor" aria-label="anchor" href="#partial-autocorrelation-plot-pacf"><i class="fas fa-link"></i></a>
</h3>
<p>The PACF is similar to the ACF plot in that it displays autocorrelation between observations and their lags, however the PACF removes the effects of other lags. Intuitively speaking, if observations are affected by the previous observation, we will see a high correlation coefficient at lag 1. However, thinking recursively, this will mean an observation is also affected by its lag 2 (i.e. the lag 1 of its lag 1). As a result, in the ACF plot, we will see a significant correlation coefficient at lag 2, and so forth (albeit more muted than lag 1). The PACF plot, however, eliminates the influence of other lags. So, for an AR(p) process, which is a time series model that basically determines a relationship between an observation and the previous p observations, we can use a PACF plot to determine the p. </p>
<div id="example-3" class="section level4">
<h4>
<span class="header-section-number">5.1.3.1</span> Example<a class="anchor" aria-label="anchor" href="#example-3"><i class="fas fa-link"></i></a>
</h4>
<p>So, let’s use a dataset where we can bring together everything we have looked at so far – the decompose function, autoplot, the acf plot and finally the pacf – and then go a step further where we attempt to identify a suitable model using the acf/pacf plots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ex_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"resources/timeseriesanalysis/TS_data.csv"</span><span class="op">)</span>

<span class="va">Ex_data_ts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Ex_data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, start <span class="op">=</span> <span class="fl">1900</span>, frequency <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggacf.html">ggacf</a></span><span class="op">(</span><span class="va">Ex_data_ts</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ex_data_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggacf.html">ggacf</a></span><span class="op">(</span><span class="op">(</span><span class="va">Ex_data_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">random</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-8-3.png" width="672" style="display: block; margin: auto;"></div>
<p>Based on the acf plot, we can definitely see that a AR(p) process is suitable, since the first few lags have high correlation coefficients. Now, let’s use a pacf plot to investigate further.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/bayesforecast/man/ggpacf.html">ggpacf</a></span><span class="op">(</span><span class="op">(</span><span class="va">Ex_data_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">random</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Based on the plot above, we can estimate that an AR(2) or AR(3) model might be suitable, since the correlation coefficients get close to zero starting at around lag 3 and lag 4.</p>
</div>
</div>
<div id="forecasting" class="section level3">
<h3>
<span class="header-section-number">5.1.4</span> Forecasting<a class="anchor" aria-label="anchor" href="#forecasting"><i class="fas fa-link"></i></a>
</h3>
<p>Forecasting time series data is one of the most important aspects of time series analysis. In order to forecast, we ought to examine certain properties of the time series processes (such as AR, MA, and ARMA) that we believe estimate our data well. For reference, the AR(1), MA(1) and ARMA(1,1) models are written below, respectively.</p>
<p><span class="math display">\[
X_t = \phi X_{t-1} +Z_t, Z_t  \sim WN(0,\sigma^2)
\]</span></p>
<p><span class="math display">\[
X_t =  \theta Z_{t-1} + Z_t, Z_t  \sim WN(0,\sigma^2)
\]</span></p>
<p><span class="math display">\[
X_t - \phi X_{t-1} =  Z_t + \theta Z_{t-1} , Z_t  \sim WN(0,\sigma^2)
\]</span></p>
<p><em>Causality and Invertibility</em> are essential characteristics in a time series process. Causality implies that the time series process can be estimated using past observations (as opposed to future observations) and invertibility means that the errors (see the <span class="math inline">\(Z_t\)</span> terms) can be represented by the past observations. Without getting into the mathematics behind it, causality can be determined by analyzing the roots of the <span class="math inline">\(X_t - \phi X_{t-1}\)</span> polynomial. If the absolute values of the roots are greater than 1, we say the process is causal.</p>
<p>Similarly, invertibility can be determined by analysing the roots of the <span class="math inline">\(Z_t + \theta Z_{t-1}\)</span> polynomial. If the absolute values of the roots are greater than 1, we say the process is invertible.</p>
<p>R has a very useful function that allows us to quickly and easily determine the roots and therefore examine the causality and invertibility of a time series process.</p>
<div id="example-4" class="section level4">
<h4>
<span class="header-section-number">5.1.4.1</span> Example<a class="anchor" aria-label="anchor" href="#example-4"><i class="fas fa-link"></i></a>
</h4>
<p>Extending upon the data in the PACF example, we will determine the causality using the roots method. We can use the <code><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima()</a></code> function from the <code>forecast</code> package in order to model the data, and then the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> function will visualise the unit circle and the <strong>inverse</strong> roots. <em>If the inverse roots are within the circle, the time series is causal.</em> Per the analysis we conducted using the PACF plot, we will use the AR(3) model on the data.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ex_data</span><span class="op">$</span><span class="va">X_1</span> <span class="op">=</span> <span class="cn">NA</span> 
<span class="va">Ex_data</span><span class="op">$</span><span class="va">X_1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span> <span class="op">=</span> <span class="va">Ex_data</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">199</span><span class="op">]</span>

<span class="va">Ex_data</span><span class="op">$</span><span class="va">X_2</span> <span class="op">=</span> <span class="cn">NA</span> 
<span class="va">Ex_data</span><span class="op">$</span><span class="va">X_2</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span> <span class="op">=</span> <span class="va">Ex_data</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">198</span><span class="op">]</span>

<span class="va">Ex_data</span><span class="op">$</span><span class="va">X_3</span> <span class="op">=</span> <span class="cn">NA</span> 
<span class="va">Ex_data</span><span class="op">$</span><span class="va">X_3</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span> <span class="op">=</span> <span class="va">Ex_data</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">197</span><span class="op">]</span>

<span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">X_1</span> <span class="op">+</span><span class="va">X_2</span> <span class="op">+</span><span class="va">X_3</span> , data <span class="op">=</span> <span class="va">Ex_data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> </code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X ~ X_1 + X_2 + X_3, data = Ex_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.5192 -0.5453  0.0193  0.4628  1.8945 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.36799    0.14234   2.585   0.0105 *  
## X_1          0.29241    0.07153   4.088 6.38e-05 ***
## X_2          0.72885    0.05236  13.921  &lt; 2e-16 ***
## X_3         -0.13416    0.07100  -1.890   0.0603 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.7006 on 193 degrees of freedom
##   (3 observations deleted due to missingness)
## Multiple R-squared:  0.7362, Adjusted R-squared:  0.7321 
## F-statistic: 179.6 on 3 and 193 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ex_data_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">autoplot</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="more-examples" class="section level4">
<h4>
<span class="header-section-number">5.1.4.2</span> More examples<a class="anchor" aria-label="anchor" href="#more-examples"><i class="fas fa-link"></i></a>
</h4>
<p>In order to drive home this concept, we will simulate a a couple AR and ARMA processes and visualise their unit roots.</p>
<div id="arma32" class="section level5">
<h5>
<span class="header-section-number">5.1.4.2.1</span> ARMA(3,2)<a class="anchor" aria-label="anchor" href="#arma32"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_ARMA_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>,<span class="va">ma_coeff</span>,<span class="va">ar_coeff</span>,<span class="va">sigma</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">n.start</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fl">.2</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">.2</span><span class="op">)</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>
  <span class="va">burnin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fl">.20</span><span class="op">*</span><span class="va">n.start</span><span class="op">)</span>
  <span class="va">model_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ma <span class="op">=</span> <span class="va">ma_coeff</span>,ar<span class="op">=</span><span class="va">ar_coeff</span><span class="op">)</span>
  <span class="va">ts_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_params</span>, n <span class="op">=</span> <span class="va">n.start</span>,sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>
  <span class="va">ts_sim</span> <span class="op">&lt;-</span> <span class="va">ts_sim</span><span class="op">[</span><span class="op">(</span><span class="va">burnin</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n.start</span><span class="op">]</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ts_sim</span><span class="op">)</span> 
<span class="op">}</span>

<span class="va">n</span><span class="op">=</span><span class="fl">1000</span>
<span class="va">ar_coeff</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">.4</span>,<span class="fl">.1</span><span class="op">)</span>
<span class="va">ma_coeff</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">.5</span><span class="op">)</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">AMRA_sim</span> <span class="op">&lt;-</span> <span class="fu">my_ARMA_sim</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>,ma_coeff<span class="op">=</span><span class="va">ma_coeff</span>,ar_coeff<span class="op">=</span><span class="va">ar_coeff</span>,sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">AMRA_sim</span>, frequency <span class="op">=</span> <span class="fl">10</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1900</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">autoplot</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="ar2" class="section level5">
<h5>
<span class="header-section-number">5.1.4.2.2</span> AR(2)<a class="anchor" aria-label="anchor" href="#ar2"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_AR_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">=</span><span class="fl">189</span>, <span class="va">ar_coeff</span>,<span class="va">sigma</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n.start</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fl">.2</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">.2</span><span class="op">)</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>
    <span class="va">burnin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fl">.20</span><span class="op">*</span><span class="va">n.start</span><span class="op">)</span>
    <span class="va">model_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="va">ar_coeff</span><span class="op">)</span>
    <span class="va">ts_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_params</span>, n <span class="op">=</span> <span class="va">n.start</span>,sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>
    <span class="va">ts_sim</span> <span class="op">&lt;-</span> <span class="va">ts_sim</span><span class="op">[</span><span class="op">(</span><span class="va">burnin</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n.start</span><span class="op">]</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ts_sim</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">ar_sim</span> <span class="op">&lt;-</span> <span class="fu">my_AR_sim</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>,ar_coeff<span class="op">=</span><span class="fl">0.5</span>,sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">ar_sim</span>, frequency <span class="op">=</span> <span class="fl">1</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1900</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">autoplot</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="forecasting-functions" class="section level4">
<h4>
<span class="header-section-number">5.1.4.3</span> Forecasting Functions<a class="anchor" aria-label="anchor" href="#forecasting-functions"><i class="fas fa-link"></i></a>
</h4>
<p>After conducting EDA and examining causality/invertibility, we can begin forecasting. R has a few functions which are very helpful in this area. The <code>forecast</code> package includes a function called <code>forecast</code> that takes a model as a parameter and extrapolates it to future time periods. The <code>ets</code> function below is an exponential smoothing model. The blue line represents the estimated value and the shaded purple areas are the confidence bands for that estimate.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">USAccDeaths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/ets.html">ets</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/forecast.html">forecast</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></div>
<p>We can also use the <code>Arima</code> function to estimate an ARMA model and then use it to forecast future values. Using the ARIMA on the simulated AR(2) model we created earlier.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">ar_sim</span>, frequency <span class="op">=</span> <span class="fl">1</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1900</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html">Arima</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/forecast.html">forecast</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span>ylab <span class="op">=</span> <span class="st">"Simulated AR(2)"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="timeseriesanalysis_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="recap" class="section level3">
<h3>
<span class="header-section-number">5.1.5</span> Recap<a class="anchor" aria-label="anchor" href="#recap"><i class="fas fa-link"></i></a>
</h3>
<p>The motivation for this project was to demonstrate how to conduct time series analyses in R in a straightforward and practical way. I wanted to extract the critical components of the theory behind time series analysis and apply it to real data. I tried to find a balance between highlighting mathematical equations and concepts, without getting lost in the weeds and straying from the practical applications. In this tutorial, I highlighted exploratory data analysis techniques, including utilising the acf and pacf plots, and decomposing the data into seasonal and trend components. Then, I explained methods to analyze the error structure of de-trended data, and highlighted a couple methods to forecast data in an suitable way. With more time and resources, I would further explore forecasting methods in R and expand on other characteristics of stationary time series data that are important to consider. Whilst I had a basic understanding of the fundamental time series concepts, this project strengthened my grasp of time series analysis and exposed me to practical methods to applying the theory in R. Additionally, I feel that creating this tutorial helped me better understand the theoretical concepts of time series and identify the significance (or the “so what”) of many of these theories. I found it helpful to connect the time series concepts to linear regression concepts that we have been trained in as statistics students. I came to realize how time series builds and expands on many of the concepts we are familiar with through our stats training so far.</p>

</div>
</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></div>
<div class="next"><a href="github-initial-setup.html"><span class="header-section-number">6</span> Github initial setup</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#time-series-analysis-in-r"><span class="header-section-number">5</span> Time Series Analysis in R</a></li>
<li>
<a class="nav-link" href="#introducing-time-series"><span class="header-section-number">5.1</span> Introducing Time Series</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#eda-of-time-series-data"><span class="header-section-number">5.1.1</span> EDA of Time Series Data</a></li>
<li><a class="nav-link" href="#autocorrelation-plot-acf"><span class="header-section-number">5.1.2</span> Autocorrelation Plot (ACF)</a></li>
<li><a class="nav-link" href="#partial-autocorrelation-plot-pacf"><span class="header-section-number">5.1.3</span> Partial Autocorrelation Plot (PACF)</a></li>
<li><a class="nav-link" href="#forecasting"><span class="header-section-number">5.1.4</span> Forecasting</a></li>
<li><a class="nav-link" href="#recap"><span class="header-section-number">5.1.5</span> Recap</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cctest/blob/main/timeseriesanalysis.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cctest/edit/main/timeseriesanalysis.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Community Contributions Test</strong>" was written by . It was last built on 2022-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
